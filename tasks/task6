import pandas as pd
from task3 import *

# Parameters:
#   dataFrame - the dataFrame of attendees
#   memberName - the name of the member to check for a potential discount
# Purpose:
#   Checks whether the member is eligible for a discount
def receiveDiscount(dataFrame, memberName):

    # A filtered dataFrame that consists of only the given member
    filteredDF = dataFrame[dataFrame['Name'] == memberName]

    # Dates of the classes from the past 3 months
    past3Months = pd.date_range(end=pd.Timestamp.now().date(), periods=12, freq='W')

    # Payments of the member from the past 3 months
    memberPayments = filteredDF[filteredDF['Class Date'].isin(past3Months)]

    # Number of payments made over the past 3 months
    totalPayments = memberPayments.shape[0]

    return totalPayments == len(past3Months)


# TESTING
"""
print("Before adding payments:")
print(receiveDiscount(previousAttendees, 'Kevin Khuu'))
print("")

# Add consecutive payments
for i in range(25):
    entry = {
        'Name': 'Kevin Khuu',
        'Phone': 1234567890,
        'Address': '123 Random Road',
        'Paid': True,
        'Class Date': (pd.date_range(end=pd.Timestamp.now().date(), periods=1, freq='W') - pd.Timedelta(weeks=i))[0]
    }
    addPrevious(entry)

#print(previousAttendees)


print("After adding payments:")
print(receiveDiscount(previousAttendees, 'Kevin Khuu'))
"""
